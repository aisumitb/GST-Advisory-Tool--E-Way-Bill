Private Sub btnCheck_Click()
    Dim invoiceValue As Double
    Dim distance As Double
    Dim mode As String
    Dim category As String
    Dim output As String

    invoiceValue = CDbl(txtInvoiceValue.Value)
    distance = CDbl(txtDistance.Value)
    mode = cboMode.Value
    category = cboCategory.Value

    ' Default result
    output = "YES"

    ' Condition 1: Exempted or Non-GST goods → No E-way bill
    If category = "Exempted" Or category = "Non-GST" Then
        output = "NO"
    End If

    ' Condition 2: Invoice value less than 50,000 → No EWB (except for notified goods)
    If invoiceValue < 50000 Then
        If category <> "Notified Goods" Then
            output = "NO"
        End If
    End If

    ' Condition 3: Distance under 50 km (within state) → No EWB for movement FROM/TO transporter
    If distance < 50 Then
        If mode = "Road" Then
            ' still need to check value condition; skip for exempt
            If invoiceValue < 50000 And category <> "Notified Goods" Then
                output = "NO"
            End If
        End If
    End If

    ' Condition 4: Non-motorised conveyance → No EWB
    If mode = "Non-motorised" Then
        output = "NO"
    End If

    ' Condition 5: Hand-carried goods (personal transport) → No EWB
    If mode = "Hand Carry" Then
        output = "NO"
    End If

    ' Final Output
        ' Condition 6: Special Transactions
    Dim special As String
    special = cboSpecial.Value

    Select Case special
        Case "Branch transfer (interstate)", _
             "Job work (interstate)", _
             "Exhibition/approval basis", _
             "Testing/lab movement", _
             "Scrap disposal", _
             "Customer return", _
             "Import/export logistics", _
             "Warranty replacements"
                output = "YES"
        Case "Goods repair & return"
                If invoiceValue > 50000 Then output = "YES" Else output = "NO"
        Case "Free samples"
                If invoiceValue > 50000 Then output = "YES" Else output = "NO"
    End Select

    lblResult.Caption = "E-Way Bill Required: " & output

End Sub

Private Sub btnClear_Click()
    txtInvoiceValue.Value = ""
    txtDistance.Value = ""
    cboMode.Value = ""
    cboCategory.Value = ""
    lblResult.Caption = ""
End Sub

Private Sub UserForm_Initialize()
    cboMode.Clear
    cboMode.AddItem "Road"
    cboMode.AddItem "Rail"
    cboMode.AddItem "Air"
    cboMode.AddItem "Ship"
    cboMode.AddItem "Non-motorised"
    cboMode.AddItem "Hand Carry"

    cboCategory.Clear
    cboCategory.AddItem "GST Goods"
    cboCategory.AddItem "Exempted"
    cboCategory.AddItem "Non-GST"
    cboCategory.AddItem "Notified Goods"

    cboSpecial.Clear
    cboSpecial.AddItem "Branch transfer (interstate)"
    cboSpecial.AddItem "Job work (interstate)"
    cboSpecial.AddItem "Exhibition/approval basis"
    cboSpecial.AddItem "Goods repair & return"
    cboSpecial.AddItem "Testing/lab movement"
    cboSpecial.AddItem "Free samples"
    cboSpecial.AddItem "Warranty replacements"
    cboSpecial.AddItem "Scrap disposal"
    cboSpecial.AddItem "Customer return"
    cboSpecial.AddItem "Import/export logistics"
End Sub

